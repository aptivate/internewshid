{% extends "base.html" %}
{% load i18n %}
{% load static %}
{% load render_upload_form %}
{% block content %}

<!-- Navigation -->

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">{% trans "Toggle navigation" %}</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/"><span><span>{{ config.CONTEXT_LOCATION }}</span></span></a>

    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav nav-pills">
        <li {% if request.resolver_match.url_name == "dashboard" %}class="active"{% endif %}><a href="{% url "dashboard" %}">Dashboard <span class="sr-only">(current)</span></a></li>
        <li {% if request.resolver_match.url_name == "tabbed-page" %}class="active"{% endif %}><a href="{% url "tabbed-page" name="main" tab_name="all" %}">Feedback</a></li>
      </ul>

      <ul class="nav navbar-nav navbar-right nav-utilities">

        {% if request.user.is_authenticated %}
        {% url 'tabbed-page' config.DEFAULT_TABBED_PAGE_NAME config.DEFAULT_TAB_NAME as next_url %}
        {% trans 'data' as type_label %}
        <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
             {% trans "Upload data" %} <span class="fa fa-caret-down"> </span>
            </a>
            <ul class="dropdown-menu">
              {% render_upload_form config.GLOBAL_DATA_SOURCE next_url type_label %}
            </ul>
        </li>
        {% endif %}

        {% if request.user.is_authenticated %}
        <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
             {% trans "Export data" %} <span class="fa fa-caret-down"> </span>
            </a>
            <ul class="dropdown-menu dropdown-user">
                <li><a href="{% url "item-export" %}">{% trans "All Feedback (CSV)" %}</a></li>
                <li><a href="{% url "location-coverage" %}">{% trans "Location data (CSV)" %}</a></li>
            </ul>
            <!-- /.dropdown-user -->
        </li>
        {% endif %}
        
        {% if request.user.is_authenticated %}
        <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
             {% trans "Settings" %}  <span class="fa fa-caret-down"> </span>
            </a>
            <ul class="dropdown-menu dropdown-user">
                <li><a href="{% url "tabbed-page" name="main" tab_name="all" %}"><span class="fa fa-user fa-fw"></span> {% blocktrans %}Your Account {{ request.user }}{% endblocktrans %}</a></li>
                <li><a href="{% url "admin:index" %}"><span class="fa fa-gear fa-fw"></span>{% trans "Administration" %}</a></li>
                <li role="separator" class="divider"></li>
                <li><a href="{% url "logout" %}?next={% url 'login' %}"><span class="fa fa-sign-out fa-fw"></span>{% trans "Log out" %}</a></li>
            </ul>
            <!-- /.dropdown-user -->
        </li>
        {% endif %}

      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

    <!-- Main Content -->
    <div id="page-wrapper">
        <div class="row">
            <div class="col-lg-12">
                <div class="row messages-box">
                    <div class="spinner">
                        <span>Loading &#133;</span>
                      <div class="rect1"></div>
                      <div class="rect2"></div>
                      <div class="rect3"></div>
                      <div class="rect4"></div>
                      <div class="rect5"></div>
                    </div>
                {% if messages %}
                    <ul class="list-unstyled">
                        {% for message in messages %}
                        <li{% if message.tags %} class="alert alert-dismissable {{ message.tags }} {% if message.tags == "error" %}bg-danger{% else %}bg-success{% endif %}"{% endif %}>
                          <button type="button" class="close" data-dismiss="alert" aria-label="{% trans "Close" %}">
                            <span aria-hidden="true">&times;</span>
                          </button>
                          {{ message|linebreaksbr }}
                        </li>
                        {% endfor %}
                    </ul>
                   {% endif %}
                </div>
                <div class="row main-content">
                    {% block maincontent %}
                    {% endblock maincontent %}
                </div>
                <footer role="contentinfo">
                    <div class="project-info">
                        <a href="http://www.internews.org" title="A project of Internews">{% trans "A project of Internews" %}</a>
                    </div>
                    <div class="site-info">
                        {% blocktrans %}Developed by <a href="http://www.aptivate.org" title="Aptivate website" rel="author">Aptivate</a>{% endblocktrans %}
                    </div>
                </footer>
            </div>
        </div>
    </div>
    <!-- /Main Content -->
{% endblock content %}
